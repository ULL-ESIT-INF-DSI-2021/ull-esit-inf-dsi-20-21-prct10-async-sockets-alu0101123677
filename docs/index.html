<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>prct08-filessytem-notes-app</title>
	<meta name="description" content="Documentation for prct08-filessytem-notes-app">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">prct08-filessytem-notes-app</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>prct08-filessytem-notes-app</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#informe-de-la-práctica-10-de-la-asignatura-de-desarrollo-de-sistemas-infórmaticos" id="informe-de-la-práctica-10-de-la-asignatura-de-desarrollo-de-sistemas-infórmaticos" style="color: inherit; text-decoration: none;">
					<h1>Informe de la Práctica 10 de la asignatura de Desarrollo de Sistemas Infórmaticos</h1>
				</a>
				<a href="#datos" id="datos" style="color: inherit; text-decoration: none;">
					<h2>Datos</h2>
				</a>
				<ul>
					<li><strong>Nombre:</strong> Bruno Lorenzo</li>
					<li><strong>Apellidos:</strong> Arroyo Pedraza</li>
					<li><strong>Gmail:</strong> alu0101123677@ull.edu.es</li>
					<li><strong>Univeridad:</strong> Universidad de La Laguna</li>
					<li><strong>Asignatura:</strong> Desarrollo de Sistemas Informáticos</li>
					<li><strong>Práctica:</strong> Práctica 10 Cliente y servidor para una aplicación de procesamiento de notas de texto</li>
				</ul>
				<p><a href="https://github.com/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct10-async-sockets-alu0101123677/actions/workflows/tests.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct10-async-sockets-alu0101123677/actions/workflows/tests.yml/badge.svg" alt="Tests"></a> <a href="https://sonarcloud.io/dashboard?id=ULL-ESIT-INF-DSI-2021_ull-esit-inf-dsi-20-21-prct10-async-sockets-alu0101123677"><img src="https://sonarcloud.io/api/project_badges/measure?project=ULL-ESIT-INF-DSI-2021_ull-esit-inf-dsi-20-21-prct10-async-sockets-alu0101123677&metric=alert_status" alt="Quality Gate Status"></a> <a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct10-async-sockets-alu0101123677?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct10-async-sockets-alu0101123677/badge.svg?branch=main" alt="Coverage Status"></a></p>
				<a href="#desarrollo" id="desarrollo" style="color: inherit; text-decoration: none;">
					<h2>Desarrollo</h2>
				</a>
				<a href="#1-introducción" id="1-introducción" style="color: inherit; text-decoration: none;">
					<h3>1. Introducción</h3>
				</a>
				<p>Informe de la decima práctica de la asignatura de <strong>Desarrollo de Sistemas Informáticos</strong>. En la práctica propuesta se ha realizado un ejercicio en <strong>typescript</strong> en los cuales trabajaremos con el sistemas de ficheros de la práctica 8 para escribir un <strong>servidor</strong> y un <strong>cliente</strong> haciendo uso de los <strong>sockets</strong> proporcionados por el módulo net de <strong>Node.js</strong>.</p>
				<p><strong>Importante:</strong> Utilizar el comando <code>npm install</code> para instalar las dependencias de desarrollo que utiliza el proyecto cuando se descargue de GitHub.</p>
				<a href="#2-objetivos" id="2-objetivos" style="color: inherit; text-decoration: none;">
					<h3>2. Objetivos</h3>
				</a>
				<p>El objetivo principal de la práctica es familiarizarse con el <strong>módulo net</strong> de Node.js y la clase <strong>EventEmitter</strong> del módulo <strong>Events</strong> de Node.js para esto realizaremos el ejercicio mencionado con anterioridad en el apartado de introducción y explicado en el apartado de desarrollo. </p>
				<a href="#3-desarrollo" id="3-desarrollo" style="color: inherit; text-decoration: none;">
					<h3>3. Desarrollo</h3>
				</a>
				<a href="#31-tareas-previas" id="31-tareas-previas" style="color: inherit; text-decoration: none;">
					<h4>3.1 Tareas previas</h4>
				</a>
				<p>Para el desarrollo de la práctica cómo tal primero hay que hacer unas preparaciones previas, hay que aceptar la asignación de la práctica 10 y preparar el entorno del proyecto, para esto es necesario el archivo <strong>package.json</strong> y <strong>tsconfig.json</strong>, así cómo crear la estructura de directorios. Además de seguir las pautas para implementar la generación de documentación por <strong>typedoc</strong>, los test unitarios realizandos con <strong>mocha</strong> y <strong>chai</strong>, el cubrimiento de código mediante <strong>instabul</strong> y <strong>coveralls</strong> y por último la implementación de <strong>GitHub Actions</strong> que llevará a cabo los test unitarios, el cubrimiento del código y la utilización del <strong>Sonar Cloud</strong> para comprobar la calidad y seguridad del código fuente.</p>
				<p>Por otro lado leer y familiarizarse familiarizarse con el <strong>módulo net</strong> de Node.js y la clase <strong>EventEmitter</strong> del módulo <strong>Events</strong> de Node.js para esto realizaremos el ejercicio mencionado con anterioridad en el apartado de introducción y explicado en el apartado de desarrollo. </p>
				<a href="#32-desarrollo" id="32-desarrollo" style="color: inherit; text-decoration: none;">
					<h4>3.2 Desarrollo</h4>
				</a>
				<p>Para esta práctica tendremos Las operaciones que podrá solicitar el cliente al servidor deberán ser las mismas que ya implementamos durante la Práctica 8, esto es, añadir, modificar, eliminar, listar y leer notas de un usuario concreto. Un usuario interactuará con el cliente de la aplicación, exclusivamente, a través de la línea de comandos. Al mismo tiempo, en el servidor, las notas se almacenarán como ficheros JSON en el sistema de ficheros y siguiendo la misma estructura de directorios utilizada durante la Práctica 8.</p>
				<p>Para la realización del ejercicio hemos realizado ciertas modificaciones a las clases <strong>Note</strong> y <strong>NoteGestor</strong>, así cómo ((eliminado el fichero *<strong>note-app</strong> y creando la clase <strong>ClassEventEmitter</strong>, los types que se encuentran en <strong>types</strong> y el <strong>cliente</strong> y el <strong>servidor</strong>.</p>
				<a href="#321-note" id="321-note" style="color: inherit; text-decoration: none;">
					<h5>3.2.1 <a href="./src/Note.ts">Note</a></h5>
				</a>
				<p>Se han modificado los métodos <strong>printTitle</strong> y <strong>printBody</strong>, en los cuales ahora comprueban de que color es el objeto nota y retorna un string con el <strong>chalk</strong> de su color correspondiente.</p>
				<a href="#322-notegestor" id="322-notegestor" style="color: inherit; text-decoration: none;">
					<h5>3.2.2 <a href="./src/NoteGestor.ts">NoteGestor</a></h5>
				</a>
				<p>Se han modificado los métodos de la clase <strong>NoteGestor</strong>, ahora los console.log() que se realizaban en cada método se guardan en una variable string llamada result y esta variable se retorna al final de la ejecución de cada método.</p>
				<a href="#323-classeventemitter" id="323-classeventemitter" style="color: inherit; text-decoration: none;">
					<h5>3.2.3 <a href="./src/ClassEventEmitter.ts">ClassEventEmitter</a></h5>
				</a>
				<p>Clase <strong>ClassEventEmitter</strong> que hereda de <strong>EventEmitter</strong>, es utilizada para ir recibiendo un mensaje a trozos e irlo juntando en un único mensaje, en el momento que reciba una señal <strong>end</strong> emitira el mensaje entero para que pueda ser utilizado.</p>
				<a href="#324-types" id="324-types" style="color: inherit; text-decoration: none;">
					<h5>3.2.4 <a href="./src/types.ts">types</a></h5>
				</a>
				<p>El fichero types define <strong>RequestType</strong> y <strong>ResponseType</strong>, las cuales son los tipos que vamos a utilizar para definir los mensajes que van a enviar el cliente y el servidor respectivamente.</p>
				<p><strong>RequestType</strong> representa una petición de solicitud del cliente, el parametro <strong>type</strong> representa los tipos de solicitud, el parametro <strong>user</strong> representa el usuario, el parametro opcional <strong>title</strong> representa el titulo de la nota, el parametro opcional <strong>body</strong> representa el cuerpo de la nota, el parametro opcional <strong>color</strong> representa el color de la nota.</p>
				<p><strong>ResponseType</strong> representa una respuesta del servidor. el parametro <strong>type</strong> representa los tipos de respuesta y el parametro <strong>message</strong> representa el contenido de la respuesta.</p>
				<a href="#325-client" id="325-client" style="color: inherit; text-decoration: none;">
					<h5>3.2.5 <a href="./src/client.ts">Client</a></h5>
				</a>
				<p>En el fichero <strong>client</strong> tenemos nuestro cliente, en el inicializamos un <strong>socket</strong> conectado inicialmente al puerto 60300 y se lo pasamos como parametro al objeto client, perteneciente a la clase <strong>ClassEventEmitter</strong>. </p>
				<p>Inicializamos una solicitud llamada request que será de tipo <strong>RequestType</strong> y a través de los yargs implementados le daremos forma a la solicitud gracias a los parametros que hemos introducido por teclado al iniciar el cliente. </p>
				<p>Utilizamos <strong>socket.write()</strong> para enviar nuestra solicitud al servidor, si no ha sido capaz de enviar la solicitud mostrará por consola un mensaje de error, al contrario, si se ha realizado con exito mostrará un mensaje de confirmación.</p>
				<pre><code class="language-typescript"><span style="color: #001080">socket</span><span style="color: #000000">.</span><span style="color: #795E26">write</span><span style="color: #000000">(</span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">request</span><span style="color: #000000">), (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">if</span><span style="color: #000000">(</span><span style="color: #001080">err</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">chalk</span><span style="color: #000000">.</span><span style="color: #795E26">red</span><span style="color: #000000">(</span><span style="color: #A31515">`La solicitud no se ha podido realizar: </span><span style="color: #0000FF">${</span><span style="color: #001080">err</span><span style="color: #000000FF">.</span><span style="color: #001080">message</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">));</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">chalk</span><span style="color: #000000">.</span><span style="color: #795E26">green</span><span style="color: #000000">(</span><span style="color: #A31515">`La solicitud se ha podido realizar`</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #001080">socket</span><span style="color: #000000">.</span><span style="color: #795E26">end</span><span style="color: #000000">();</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">});</span>
</code></pre>
				<p><strong>client.on(&#39;message&#39;)</strong> recoge el mensaje de respuesta que recibimos desde el servidor y que emitimos gracias a que el objeto client es un objeto de la clase ClassEventEmitter. Una vez que tenemos el mensaje mostramos por consola el apartado message de la respuesta recibida.</p>
				<pre><code class="language-typescript"><span style="color: #001080">client</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;message&#039;</span><span style="color: #000000">, (</span><span style="color: #001080">message</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #001080">message</span><span style="color: #000000">);</span>
<span style="color: #000000">});</span>
</code></pre>
				<p>En caso de que la conexión no se pudiera establecer tenemos el <strong>client.on(&#39;error&#39;)</strong> que nos comunica por consola este suceso.</p>
				<pre><code class="language-typescript"><span style="color: #001080">client</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;error&#039;</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">chalk</span><span style="color: #000000">.</span><span style="color: #795E26">red</span><span style="color: #000000">(</span><span style="color: #A31515">`La conexión no se ha podido establecer: </span><span style="color: #0000FF">${</span><span style="color: #001080">err</span><span style="color: #000000FF">.</span><span style="color: #001080">message</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">));</span>
<span style="color: #000000">});</span>
</code></pre>
				<p>Se puede inicializar el cliente de las siguientes maneras, teniendo en cuenta que los colores validos son Rojo, Verde, Azul y Amarillo.</p>
				<pre><code class="language-bash"><span style="color: #001080">$node</span><span style="color: #000000"> dist/client.js add --user=</span><span style="color: #A31515">&quot;usuario&quot;</span><span style="color: #000000"> --title=</span><span style="color: #A31515">&quot;titulo&quot;</span><span style="color: #000000"> --body=</span><span style="color: #A31515">&quot;cuerpo de la nota&quot;</span><span style="color: #000000"> --color=</span><span style="color: #A31515">&quot;color de la nota&quot;</span>

<span style="color: #001080">$node</span><span style="color: #000000"> dist/client.js modify --user=</span><span style="color: #A31515">&quot;usuario&quot;</span><span style="color: #000000"> --title=</span><span style="color: #A31515">&quot;titulo&quot;</span><span style="color: #000000"> --body=</span><span style="color: #A31515">&quot;cuerpo de la nota&quot;</span><span style="color: #000000"> --color=</span><span style="color: #A31515">&quot;color de la nota&quot;</span>

<span style="color: #001080">$node</span><span style="color: #000000"> dist/client.js remove --user=</span><span style="color: #A31515">&quot;usuario&quot;</span><span style="color: #000000"> --title=</span><span style="color: #A31515">&quot;titulo&quot;</span><span style="color: #000000"> </span>

<span style="color: #001080">$node</span><span style="color: #000000"> dist/client.js </span><span style="color: #795E26">read</span><span style="color: #000000"> --user=</span><span style="color: #A31515">&quot;usuario&quot;</span><span style="color: #000000"> --title=</span><span style="color: #A31515">&quot;titulo&quot;</span>

<span style="color: #001080">$node</span><span style="color: #000000"> dist/client.js list --user=</span><span style="color: #A31515">&quot;usuario&quot;</span>
</code></pre>
				<a href="#326-server" id="326-server" style="color: inherit; text-decoration: none;">
					<h5>3.2.6 <a href="./src/server.ts">Server</a></h5>
				</a>
				<p>En el fichero <strong>server</strong> tenemos nuestro servidor, para crear nuestro servidor utilizamos el  módulo net y es muy importante inicializarlo con la opción {allowHalfOpen: true}. Una vez creado nuestro servidor este estará pendiente del puerto 60300, puerto elegido en donde se conectarán nuestros clientes.</p>
				<p>Cada vez que un cliente se conecte se ejecutará el callback del servidor, este callback tiene como parametro un objeto Socket con el cual podremos recibir y enviar datos a los clientes conectados. En el momento que un cliente se conecte se nos notificará por consola y acto seguido creamos el objeto socket, un objeto de la clase <strong>ClassEventEmitter</strong> que recibe como parametro el socket del servidor, connection.</p>
				<p>En el momento en el que nuestro servidor reciba un mensaje del cliente, el callback de <strong>socket.on(&#39;message&#39;)</strong>, mostrará por pantalla que la solicitud ha sido recibida e inicilizará una respuesta de tipo <strong>ResponseType</strong>, este será el mensaje que enviaremos de vuelta al cliente con la respuesta, a continuación mediante un switch aplicamos el caso correspondiente al tipo de solicitud que ha enviado el cliente comprobando el message.type, en cada caso ejecutamos el método correspondiente de la clase NoteGestor y el return lo guardamos en el apartado message de nuestra respuesta.</p>
				<p>Cuando se realize el switch ya tendremos en nuestra respuesta el resultado de la operación, el cuál mediante <strong>connection.write()</strong> será enviado a nuestro cliente.</p>
				<p>En caso de que un cliente se desconecte o la conexión no se pueda realizar contamos con un <strong>connection.on(&#39;error&#39;)</strong> y un <strong>connection.on(&#39;close&#39;)</strong></p>
				<a href="#4-conclusiones" id="4-conclusiones" style="color: inherit; text-decoration: none;">
					<h3>4. Conclusiones</h3>
				</a>
				<p>En conclusión, la introducción de los <strong>sockets</strong> a nuestro programa nos introduce aún más en el día a día y en casos de la vida real al utilizar un cliente-servidor, esto aplicado también a lo que hemos realizado con anterioridad aporta mucha más profundidad a la de trabajar con typescript. </p>
				<a href="#5-bibliografía" id="5-bibliografía" style="color: inherit; text-decoration: none;">
					<h3>5. Bibliografía</h3>
				</a>
				<p><a href="https://ull-esit-inf-dsi-2021.github.io/prct10-async-sockets/">Guión de la práctica 10</a></p>
				<p><a href="https://ull-esit-inf-dsi-2021.github.io/nodejs-theory/nodejs-intro.html">Introducción a Node.js</a></p>
				<p><a href="https://ull-esit-inf-dsi-2021.github.io/nodejs-theory/nodejs-filesystem.html">Introducción al sistema de ficheros en Node.js</a></p>
				<p><a href="https://www.npmjs.com/package/yargs">Yarg</a></p>
				<p><a href="https://www.npmjs.com/package/chalk">Chalk</a></p>
				<p><a href="https://nodejs.org/dist/latest-v15.x/docs/api/fs.html#fs_synchronous_api">API síncrona</a> </p>
				<p><a href="https://ull-esit-inf-dsi-2021.github.io/nodejs-theory/nodejs-sockets.html">Apuntes de sockets</a></p>
				<p><a href="https://nodejs.org/dist/latest-v16.x/docs/api/net.html">Modulo net</a></p>
				<p><a href="https://nodejs.org/dist/latest-v16.x/docs/api/events.html#events_class_eventemitter">Eventmitter</a></p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/classeventemitter.html">Class<wbr>Event<wbr>Emitter</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/note.html">Note</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/notegestor.html">Note<wbr>Gestor</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/client.html">client</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/server.html">server</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/types.html">types</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>